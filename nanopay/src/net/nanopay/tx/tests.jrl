p({"class":"foam.nanos.test.Test","id":"net.nanopay.tx.TransactionAdapterDAOTest","server":false,"code":"userDAO        = x.get(\"userDAO\");\naccountDAO     = x.get(\"accountDAO\");\ninstitutionDAO = x.get(\"institutionDAO\");\ntransactionDAO = x.get(\"localTransactionDAO\");\nbalanceDAO     = x.get(\"balanceDAO\");\nliquiditySettingsDAO = x.get(\"liquiditySettingsDAO\");\n\nRandom ran = new Random();\n\n//Create a Test User\nuser = new foam.nanos.auth.User();\nuser.setId(Long.valueOf(1050));\nuser.setGroup(\"business\");\nuser.setOrganization(\"Balony\");\nuser.setEmailVerified(true);\nuser.setFirstName(\"test8\");\nuser.setLastName(\"TEST8\");\nuser.setEmail(\"test8@t.com\");\nuserDAO.put(user);\n\n//Create a Test User\nuser = new foam.nanos.auth.User();\nuser.setId(Long.valueOf(1055));\nuser.setGroup(\"business\");\nuser.setOrganization(\"Balony\");\nuser.setEmailVerified(true);\nuser.setFirstName(\"test9\");\nuser.setLastName(\"TEST9\");\nuser.setEmail(\"test9@t.com\");\nuserDAO.put(user);\n\n//Grab Users for test\ntestDigital1        =(foam.nanos.auth.User) userDAO.find(1050);\ntestDigital2        =(foam.nanos.auth.User) userDAO.find(1055);\nadmin               =(foam.nanos.auth.User) userDAO.find(1350);\n\n//Grab Digital Accounts for test\nuserDigitalAccount  = net.nanopay.account.DigitalAccount.findDefault(x,admin,\"CAD\");\ntestDigitalAccount1 = net.nanopay.account.DigitalAccount.findDefault(x,testDigital1,\"CAD\");\ntestDigitalAccount2 = net.nanopay.account.DigitalAccount.findDefault(x,testDigital2,\"CAD\");\n\nls = new net.nanopay.tx.model.LiquiditySettings();\nls.setEnableCashIn(false);\nls.setEnableCashOut(false);\nls.setId(userDigitalAccount.getId());\nliquiditySettingsDAO.put(ls);\n\nls = new net.nanopay.tx.model.LiquiditySettings();\nls.setEnableCashIn(false);\nls.setEnableCashOut(false);\nls.setId(testDigitalAccount1.getId());\nliquiditySettingsDAO.put(ls);\n\nls = new net.nanopay.tx.model.LiquiditySettings();\nls.setEnableCashIn(false);\nls.setEnableCashOut(false);\nls.setId(testDigitalAccount2.getId());\nliquiditySettingsDAO.put(ls);\n\n//Create a bank account to User 1350\ncaaccount1 = new net.nanopay.bank.CABankAccount();\ncaaccount1.setAccountNumber(\"\"+(ran.nextInt(1000000)+10000));\ncaaccount1.setInstitutionNumber(\"\"+(ran.nextInt(899) + 100));\ncaaccount1.setBranchId(\"\"+(ran.nextInt(89999) + 10000));\ncaaccount1.setOwner(1350);\ncaaccount1.setName(\"\"+ran.nextInt(1000));\ncaaccount1.setStatus(net.nanopay.bank.BankAccountStatus.VERIFIED);\ncaaccount1.setDenomination(\"CAD\");\ncaaccount1.setId(1351);\ncaaccount1 = accountDAO.put(caaccount1);\n\nls = new net.nanopay.tx.model.LiquiditySettings();\nls.setEnableCashIn(false);\nls.setEnableCashOut(false);\nls.setId(caaccount1.getId());\nliquiditySettingsDAO.put(ls);\n\ntransaction = new net.nanopay.tx.model.Transaction();\ntransaction.setDestinationAccount(userDigitalAccount.getId());\ntransaction.setSourceAccount(caaccount1.getId());\ntransaction.setAmount(300000);\ntransaction.setStatus(net.nanopay.tx.model.TransactionStatus.COMPLETED);\ntransaction = transactionDAO.put(transaction);\n\ntest(transaction instanceof net.nanopay.tx.alterna.AlternaCITransaction, \"CABankAccount/DigitalAccount -> AlternaTransaction\");\n\n//Create a bank account to User 1055\ncaaccount2 = new net.nanopay.bank.CABankAccount();\ncaaccount2.setAccountNumber(\"\"+(ran.nextInt(1000000)+10000));\ncaaccount2.setInstitutionNumber(\"\"+(ran.nextInt(899) + 100));\ncaaccount2.setBranchId(\"\"+(ran.nextInt(89999) + 10000));\ncaaccount2.setOwner(1055);\ncaaccount2.setName(\"\"+ran.nextInt(1000));\ncaaccount2.setStatus(net.nanopay.bank.BankAccountStatus.VERIFIED);\ncaaccount2.setDenomination(\"CAD\");\ncaaccount2 = accountDAO.put(caaccount2);\n\nls = new net.nanopay.tx.model.LiquiditySettings();\nls.setEnableCashIn(false);\nls.setEnableCashOut(false);\nls.setId(caaccount2.getId());\nliquiditySettingsDAO.put(ls);\n\ntransaction = new net.nanopay.tx.model.Transaction();\ntransaction.setDestinationAccount(caaccount2.getId());\ntransaction.setSourceAccount(caaccount1.getId());\ntransaction.setAmount(300);\n//transaction.setStatus(net.nanopay.tx.model.TransactionStatus.COMPLETED);\ntransaction = transactionDAO.put(transaction);\n\ntest(transaction instanceof net.nanopay.tx.CompositeTransaction, \"CABankAccount/CABankAccount -> CompositeTransaction\");\ntransactions = transaction.queued;\ntest(transactions.length >= 1, \"CompositeTransaction transactions size >= 1\");\ntest(transactions[0] instanceof net.nanopay.tx.alterna.AlternaTransaction, \"CompositeTransaction transactions[0] AlternaTransaction\");\n\nbalance = userDigitalAccount.findBalance(x);\ntest(balance > 0, \"balance > 0\");\ntransaction = new net.nanopay.tx.model.Transaction();\ntransaction.setDestinationAccount(testDigitalAccount2.getId());\ntransaction.setSourceAccount(userDigitalAccount.getId());\ntransaction.setAmount(balance);\n\n//transaction.setStatus(net.nanopay.tx.model.TransactionStatus.COMPLETED);\ntransaction = transactionDAO.put(transaction);\n\ntest(transaction.getClass().equals(net.nanopay.tx.model.Transaction.class), \"DigitalAccount/DigitalAccount -> Transaction\");\n","output":"SUCCESS: CABankAccount/DigitalAccount -> AlternaTransaction\nSUCCESS: CABankAccount/CABankAccount -> CompositeTransaction\nSUCCESS: CompositeTransaction transactions size >= 1\nSUCCESS: CompositeTransaction transactions[0] AlternaTransaction\nbalance: 300000\nSUCCESS: balance > 0\nSUCCESS: DigitalAccount/DigitalAccount -> Transaction\n"})
p({"class":"net.nanopay.tx.NanopayTransactionFeeDAOTest","id":"NanopayTransactionFeeDAOTest"})
