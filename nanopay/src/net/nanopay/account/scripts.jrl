p({"class":"foam.nanos.script.Script","id":"CreateAbliiOverdraftAccounts","code":"import net.nanopay.account.DigitalAccount;\nimport net.nanopay.account.OverdraftAccount;\nimport net.nanopay.account.DebtAccount;\nimport net.nanopay.account.DigitalAccountService;\nimport foam.nanos.auth.User;\nimport foam.nanos.auth.Group;\nimport foam.mlang.MLang;\n\nclearing = 6L; // nanopay Clearing Account\ns = x.get(\"digitalAccount\");\nd = x.get(\"businessDAO\");\na = x.get(\"accountDAO\");\nbusinesses = d.select().array;\nprint(\"businesses: \"+businesses.size());\nfor ( b : businesses ) {\n    try {\n        y = x.put(\"user\", b);\n        o = s.findDefault(y, \"CAD\").fclone();\n        o.setName(b.getGroup());\n        o = a.put(o);\n        print(o.type+\" \"+o);\n        print(o.debtAccount);\n        t = o.findDebtAccount(x).fclone();\n        print(t.type+\" \"+t);\n        t.setCreditorAccount(clearing);\n        t = a.put(t);\n    } catch ( Exception e ) {\n        print(b);\n        print(t.getMessage());\n    }\n}\n"})
