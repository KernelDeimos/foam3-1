<h1 id="xsdtofoam">XSD to FOAM</h1>
<h3 id="overview">Overview</h3>
<p>Through the use of scripts, we have the ability to parse XSD schema files to generate FOAM models. This greatly
  reduces the pain of having to model each message by hand which would otherwise be a very tedious property.
  The scripts are also able to add any property level validation that may be contained in the schema.</p>
<h3 id="dependencies">Dependencies</h3>
<p>The XSD parser &amp; model generator script use node.js and require the following packages:</p>
<ul>
  <li>json-stringify-pretty-compact: ^1.0.4</li>
  <li>mkdir: ^0.5.1</li>
  <li>underscore: ^1.8.3</li>
  <li>xmldom : ^0.1.27</li>
</ul>
<h3 id="usage">Usage</h3>
<p>To generate FOAM models from an XSD file by invoking the following command in the top level project directory
  (NANOPAY/):</p>
<code>node tools/xsd/index.js
  <package>
    <files>...
</code>
<p>It will look for XSD files in the following directory. Providing a fully qualified path will not work.</p>
<code>NANOPAY/tools/xsd/messages
</code>
<p>Two additional files are created as a byproduct of the script:</p>
<ul>
  <li><b>classes.js</b>: allows for seamless integration into our Java code generation scripts.</li>
  <li><b>files.js</b>: allows us to use the model on the web client.</li>
</ul>
<p><strong>Example</strong></p>
<code>node tools/xsd/index.js net.nanopay.iso20022 \
  pacs.002.001.09.xsd \
  pacs.008.001.06.xsd \
  pacs.028.001.01.xsd \
  pain.007.001.07.xsd \
  tsin.004.001.01.xsd
</code>
<p>The above script will generate all of the models (as well as classes.js and files.js) in the following directory:</p>
<code>NANOPAY/nanopay/src/net/nanopay/iso20022
</code>
<h3 id="namespaces">Namespaces</h3>
<p>The script is currently only able to parse XSD files that use the namespace <code>xs</code>. For example:</p>
<code>
  <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="Test" type="xs:string"/>
  </xs:schema>
</code>
<p>An XSD file using any other namespace (for example <code>xsd</code>) must be modified to use <code>xs</code> for the
  parser to work.</p>
<h3 id="parsingwsdlfiles">Parsing WSDL files</h3>
<p>While the scripts themselves are not able to parse WSDL files directly, we can extract XSD files from the file to be
  able to more easily generate models. As outlined <a href="https://www.w3schools.com/xml/xml_wsdl.asp">here</a>, WSDL
  files contain a type section. This type section defines an XSD schema which, if extracted into a separate file, can be
  used to generate all the models required.</p>
